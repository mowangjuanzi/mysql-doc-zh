
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <title>使用 Docker 部署 MySQL 服务器的基本步骤 · HonKit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 4.0.7">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="docker-mysql-more-topics.html" />
    
    
    <link rel="prev" href="linux-installation-docker.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="preface.html">
            
                <a href="preface.html">
            
                    
                    前言和法律条款
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="installing.html">
            
                <a href="installing.html">
            
                    
                    安装和更新 MySQL
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="linux-installation.html">
            
                <a href="linux-installation.html">
            
                    
                    在 Linux 上安装 MySQL
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="linux-installation-apt-repo.html">
            
                <a href="linux-installation-apt-repo.html">
            
                    
                    在 Linux 上使用 APT 库安装 MySQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="linux-installation-docker.html">
            
                <a href="linux-installation-docker.html">
            
                    
                    在 Linux 上使用 Docker 部署 MySQL
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.3.1.2.1" data-path="docker-mysql-getting-started.html">
            
                <a href="docker-mysql-getting-started.html">
            
                    
                    使用 Docker 部署 MySQL 服务器的基本步骤
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2" data-path="docker-mysql-more-topics.html">
            
                <a href="docker-mysql-more-topics.html">
            
                    
                    使用 Docker 部署 MySQL 服务器的更多主题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="tutorial.html">
            
                <a href="tutorial.html">
            
                    
                    教程
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="connecting-disconnecting.html">
            
                <a href="connecting-disconnecting.html">
            
                    
                    连接到服务器和从服务器断开
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="entering-queries.html">
            
                <a href="entering-queries.html">
            
                    
                    输入查询
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="database-use.html">
            
                <a href="database-use.html">
            
                    
                    创建和使用数据库
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="creating-database.html">
            
                <a href="creating-database.html">
            
                    
                    创建和选择数据库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="creating-tables.html">
            
                <a href="creating-tables.html">
            
                    
                    创建表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.3" data-path="loading-tables.html">
            
                <a href="loading-tables.html">
            
                    
                    将数据加载到表中
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4" data-path="retrieving-data.html">
            
                <a href="retrieving-data.html">
            
                    
                    从表中检索数据
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.4.1" data-path="selecting-all.html">
            
                <a href="selecting-all.html">
            
                    
                    选择所有数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.2" data-path="selecting-rows.html">
            
                <a href="selecting-rows.html">
            
                    
                    选择特定行
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.3" data-path="selecting-columns.html">
            
                <a href="selecting-columns.html">
            
                    
                    选择指定列
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.4" data-path="sorting-rows.html">
            
                <a href="sorting-rows.html">
            
                    
                    行排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.5" data-path="date-calculations.html">
            
                <a href="date-calculations.html">
            
                    
                    日期计算
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.6" data-path="working-with-null.html">
            
                <a href="working-with-null.html">
            
                    
                    处理 NULL 值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.7" data-path="pattern-matching.html">
            
                <a href="pattern-matching.html">
            
                    
                    模式匹配
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.8" data-path="counting-rows.html">
            
                <a href="counting-rows.html">
            
                    
                    计算行数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.9" data-path="multiple-tables.html">
            
                <a href="multiple-tables.html">
            
                    
                    使用多个表
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="getting-information.html">
            
                <a href="getting-information.html">
            
                    
                    获取数据库和表的信息
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="batch-mode.html">
            
                <a href="batch-mode.html">
            
                    
                    在批处理模式使用 mysql
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="examples.html">
            
                <a href="examples.html">
            
                    
                    常见查询示例
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.6.1" data-path="example-maximum-column.html">
            
                <a href="example-maximum-column.html">
            
                    
                    列的最大值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.2" data-path="example-maximum-row.html">
            
                <a href="example-maximum-row.html">
            
                    
                    包含某一行最大值的记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.3" data-path="example-maximum-column-group.html">
            
                <a href="example-maximum-column-group.html">
            
                    
                    每组中列的最大值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.4" data-path="example-maximum-column-group-row.html">
            
                <a href="example-maximum-column-group-row.html">
            
                    
                    拥有某个字段的组间最大值的行
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.5" data-path="example-user-variables.html">
            
                <a href="example-user-variables.html">
            
                    
                    使用用户自定义变量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.6" data-path="example-foreign-keys.html">
            
                <a href="example-foreign-keys.html">
            
                    
                    使用外键
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.7" data-path="searching-on-two-keys.html">
            
                <a href="searching-on-two-keys.html">
            
                    
                    两个键上搜索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.8" data-path="calculating-days.html">
            
                <a href="calculating-days.html">
            
                    
                    计算每日访问量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.9" data-path="example-auto-increment.html">
            
                <a href="example-auto-increment.html">
            
                    
                    使用 AUTO_INCREMENT
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="apache.html">
            
                <a href="apache.html">
            
                    
                    在 Apache 中使用 MySQL
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="programs.html">
            
                <a href="programs.html">
            
                    
                    MySQL 程序
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="programs-client.html">
            
                <a href="programs-client.html">
            
                    
                    MySQL 客户端程序
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="mysql.html">
            
                <a href="mysql.html">
            
                    
                    mysql — MySQL 命令行客户端
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="optimization.html">
            
                <a href="optimization.html">
            
                    
                    优化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="optimize-overview.html">
            
                <a href="optimize-overview.html">
            
                    
                    优化概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="statement-optimization.html">
            
                <a href="statement-optimization.html">
            
                    
                    优化 SQL 语句
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="optimization-indexes.html">
            
                <a href="optimization-indexes.html">
            
                    
                    优化和索引
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="optimizing-database-structure.html">
            
                <a href="optimizing-database-structure.html">
            
                    
                    优化数据库结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="optimizing-innodb.html">
            
                <a href="optimizing-innodb.html">
            
                    
                    优化 InnoDB 表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="optimizing-myisam.html">
            
                <a href="optimizing-myisam.html">
            
                    
                    优化 MyISAM 表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="optimizing-memory-tables.html">
            
                <a href="optimizing-memory-tables.html">
            
                    
                    优化 MEMORY 表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="execution-plan-information.html">
            
                <a href="execution-plan-information.html">
            
                    
                    理解查询执行计划
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="controlling-optimizer.html">
            
                <a href="controlling-optimizer.html">
            
                    
                    控制查询优化器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="buffering-caching.html">
            
                <a href="buffering-caching.html">
            
                    
                    缓冲和缓存
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11" data-path="locking-issues.html">
            
                <a href="locking-issues.html">
            
                    
                    优化锁操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.12" data-path="optimizing-server.html">
            
                <a href="optimizing-server.html">
            
                    
                    优化 MySQL 服务器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.13" data-path="optimize-benchmarking.html">
            
                <a href="optimize-benchmarking.html">
            
                    
                    测量性能 (Benchmarking)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.14" data-path="thread-information.html">
            
                <a href="thread-information.html">
            
                    
                    检查线程信息
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="data-types.html">
            
                <a href="data-types.html">
            
                    
                    数据类型
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            本书使用 HonKit 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >使用 Docker 部署 MySQL 服务器的基本步骤</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h4 id="2561-使用-docker-部署-mysql-服务器的基本步骤">2.5.6.1 使用 Docker 部署 MySQL 服务器的基本步骤</h4>
<blockquote>
<p><strong>警告</strong></p>
<p>MySQL 团队维护的 MySQL Docker 镜像是专门为 Linux 平台构建的. 不支持其他平台, 使用这些 MySQL Docker 镜像的用户自行承担风险. 有关在非 Linux 操作系统中运行这些容器的一些已知限制, 请参阅<a href="https://dev.mysql.com/doc/refman/8.0/en/deploy-mysql-nonlinux-docker.html" target="_blank">此处的讨论</a>.</p>
</blockquote>
<h5 id="接受许可协议并使用docker-client登录-mysql企业版">接受许可协议并使用Docker Client登录 (MySQL企业版)</h5>
<p><em>使用 MySQL 企业版的 Docker 镜像需要订阅.</em> 订阅的工作原理是携带你自己的许可证模型; 参阅 <a href="https://www.mysql.com/buy-mysql/" target="_blank">如何购买 MySQL 产品和服务</a> 获取详情. 在下载 MySQL 企业版镜像之前, 你需要接受许可协议并登录到容器库.</p>
<p>从 Oracle 容器库下载:</p>
<ul>
<li><p>在 <a href="https://container-registry.oracle.com/" target="_blank">https://container-registry.oracle.com/</a> 浏览 Oracle 容器库并选择 MySQL.</p>
</li>
<li><p>在 MySQL 库列表下, 选择 <code>enterprise-server</code>.</p>
</li>
<li><p>如果你至今没有登录到 Oracle 容器库, 点击页面右侧的 <code>Sign in</code> 按钮, 然后在提示时输入你的 Oracle 账户凭证.</p>
</li>
<li><p>按照页面右侧的说明接受许可协议.</p>
</li>
<li><p>使用你的 Docker 客户端 (<code>docker</code> 命令) 登录 Oracle 容器源. 使用 <code>docker login</code> 命令:</p>
</li>
</ul>
<pre><code class="lang-bash"><span class="hljs-comment"># docker login container-registry.oracle.com </span>
Username: Oracle-Account-ID
Password: password
Login successful.
</code></pre>
<p>从 Docker 商店下载:</p>
<ul>
<li><p>在 <a href="https://store.docker.com/images/mysql-enterprise-server" target="_blank">https://store.docker.com/images/mysql-enterprise-server</a> 浏览 MySQL 服务器企业版页面.</p>
</li>
<li><p>如果你还没登录到 Docker 商店, 使用 <strong>Log in</strong> 链接和你的 Docker 证书进行登录.</p>
</li>
<li><p>点击出现的 <strong>Proceed to Checkout</strong> 按钮.</p>
</li>
<li><p>按照页面右侧的说明接受许可协议.</p>
</li>
<li><p>使用 Docker 客户端 (<code>docker</code> 命令) 登录到 Docker 商店. 使用 <code>docker login</code> 命令:</p>
</li>
</ul>
<pre><code class="lang-bash"><span class="hljs-comment"># docker login</span>
Username: Docker-ID
Password: password
Login successful.
</code></pre>
<h5 id="下载-mysql-服务器-docker-镜像">下载 MySQL 服务器 Docker 镜像</h5>
<p>严格来说, 在单独的步骤中下载服务器镜像不是必需的; 然而, 在创建容器之前执行此步骤可以确保本地镜像是最新的. 下载 MySQL 社区版镜像, 运行命令:</p>
<pre><code class="lang-bash">docker pull mysql/mysql-server:tag
</code></pre>
<p><code>tag</code> 是你想拉取的镜像版本的标签 (例如, <code>5.5</code>, <code>5.6</code>, <code>5.7</code>, <code>8.0</code>, 或者 <code>latest</code>). 如果 <code>:tag</code> 被省略, 将使用 <code>latest</code> 标签, 下载 MySQL 社区服务器的最新 GA 版本镜像. 在 <a href="https://hub.docker.com/r/mysql/mysql-server/tags/" target="_blank">Docker Hub 的 mysql/mysql-server 页面</a> 参考可用版本的标签列表.</p>
<p>列出已下载的 Docker 镜像:</p>
<pre><code class="lang-bash">shell&gt; docker images
REPOSITORY           TAG                 IMAGE ID            CREATED             SIZE
mysql/mysql-server   latest              3157d7f55f8d        4 weeks ago         241MB
</code></pre>
<p>从 Docker 商店下载 MySQL 企业版镜像:</p>
<pre><code class="lang-bash">docker pull  store/oracle/mysql-enterprise-server:tag
</code></pre>
<p>从 Oracle 容器源下载 MySQL 企业版镜像:</p>
<pre><code class="lang-bash">docker pull  container-registry.oracle.com/mysql/enterprise-server:tag
</code></pre>
<p><code>tag</code> 有不同的选择, 对应 MySQL 团队在 Oracle 提供的两个版本的 MySQL 企业版 Docker 镜像:</p>
<p><code>8.0</code>, <code>8.0.x</code> (<code>x</code> 是 8.0 系列的最新版本号): MySQL 8.0 企业版，最新的GA</p>
<p><code>5.7</code>, <code>5.7.y</code> (<code>y</code> 是 85.7 系列的最新版本号): MySQL 5.7 企业版</p>
<h5 id="启动-mysql-服务器实例">启动 MySQL 服务器实例</h5>
<p>为 MySQL 社区版服务器启动一个新的 Docker 容器:</p>
<pre><code class="lang-bash">docker run --name=mysql1 -d mysql/mysql-server:tag
</code></pre>
<p>使用此命令为 MySQL 企业版服务器启动一个新的 Docker 容器, 如果 Docker 镜像是从 Oracle 容器库中下载的:</p>
<pre><code class="lang-bash">docker run --name=mysql1 -d container-registry.oracle.com/mysql/enterprise-server:tag
</code></pre>
<p>使用此命令为 MySQL 企业版服务器启动一个新的 Docker 容器, 如果 Docker 镜像是从 Docker 商店下载的:</p>
<pre><code class="lang-bash">docker run --name=mysql1 -d store/oracle/mysql-enterprise-server:tag
</code></pre>
<p><code>--name</code> 选项, 用于为服务器容器提供自定义命令 (在本示例中是 <code>mysql1</code>), 可选; 如果没有提供容器名称, 会随机生成一个. 如果指定名称和 tag 的镜像没有在以前通过 <code>docker pull</code> 或者 <code>docker run</code> 命令下载, 则现在讲下载该镜像. 下载完成后, 开始初始化容器, 当你运行 <code>docker ps</code> 命令时, 容器会出现在正在运行的容器列表中; 例如:</p>
<pre><code class="lang-bash">shell&gt; docker ps
CONTAINER ID   IMAGE                COMMAND                  CREATED             STATUS                              PORTS                NAMES
a24888f0d6f4   mysql/mysql-server   <span class="hljs-string">&quot;/entrypoint.sh my...&quot;</span>   14 seconds ago      Up 13 seconds (health: starting)    3306/tcp, 33060/tcp  mysql1
</code></pre>
<p>容器初始化可能需要一些时间. 当服务器准备好使用时, 容器在状态在 <code>docker ps</code> 命令的输出中从 <code>(health: starting)</code> 到 <code>(healthy)</code>.</p>
<p>在 <code>docker run</code> 命令中使用 <code>-d</code> 选项使容器在后台运行. 使用这个命令监视容器的输出:</p>
<pre><code class="lang-bash">docker logs mysql1
</code></pre>
<p>初始化完成后, 命令输出包含为 root 用户生成的随机密码; 例如, 使用这个命令查询密码:</p>
<pre><code class="lang-bash">shell&gt; docker logs mysql1 2&gt;&amp;1 | grep GENERATED
GENERATED ROOT PASSWORD: Axegh3kAJyDLaRuBemecis&amp;EShOs
</code></pre>
<h5 id="从容器内连接到-mysql-服务器">从容器内连接到 MySQL 服务器</h5>
<p>一旦服务器准备好了, 你可以在你刚启动的 MySQL Server 容器中运行 <a href="https://dev.mysql.com/doc/refman/8.0/en/mysql.html" target="_blank">mysql</a> 客户端, 并连接到 MySQL Server. 使用 <code>docker exec -it</code> 命令在已运行的 Docker 容器内启动 <a href="https://dev.mysql.com/doc/refman/8.0/en/mysql.html" target="_blank">mysql</a> 客户端, 如下所示:</p>
<pre><code class="lang-bash">docker <span class="hljs-built_in">exec</span> -it mysql1 mysql -uroot -p
</code></pre>
<p>当询问时, 输入生成的 root 密码 (有关如何查找密码, 请参阅 <a href="https://dev.mysql.com/doc/refman/8.0/en/docker-mysql-getting-started.html#docker-starting-mysql-server" target="_blank">启动 MySQL 服务器实例</a> 的最后一步). 因为 <a href="https://dev.mysql.com/doc/refman/8.0/en/docker-mysql-more-topics.html#docker_var_mysql_onetime_password" target="_blank"><code>MYSQL_ONETIME_PASSWORD</code></a> 选项默认为 true, 当 <a href="https://dev.mysql.com/doc/refman/8.0/en/mysql.html" target="_blank">mysql</a> 客户端连接服务器之后, 你必须通过发出此语句重置服务器 root 密码:</p>
<pre><code class="lang-bash">mysql&gt; ALTER USER <span class="hljs-string">&apos;root&apos;</span>@<span class="hljs-string">&apos;localhost&apos;</span> IDENTIFIED BY <span class="hljs-string">&apos;password&apos;</span>;
</code></pre>
<p>使用你选择的密码替换 <code>password</code>. 重置密码后, 服务器就可以使用了.</p>
<h5 id="容器-shell-访问">容器 Shell 访问</h5>
<p>让 shell 访问 MySQL 服务器容器, 使用 <code>docker exec -it</code> 命令在容器内启动 bash shell:</p>
<pre><code class="lang-bash">shell&gt; docker <span class="hljs-built_in">exec</span> -it mysql1 bash 
bash-4.2<span class="hljs-comment">#</span>
</code></pre>
<p>然后可以在容器中运行 Linux 命令. 例如, 查看容器内服务器数据目录的内容, 使用此命令:</p>
<pre><code class="lang-bash">bash-4.2<span class="hljs-comment"># ls /var/lib/mysql</span>
auto.cnf    ca.pem         client-key.pem  ib_logfile0  ibdata1  mysql       mysql.sock.lock       private_key.pem  server-cert.pem  sys
ca-key.pem  client-cert.pem  ib_buffer_pool  ib_logfile1  ibtmp1   mysql.sock  performance_schema  public_key.pem   server-key.pem
</code></pre>
<h5 id="停止和删除-mysql-容器">停止和删除 MySQL 容器</h5>
<p>停止我们创建的 MySQL 服务器容器, 使用这个命令:</p>
<pre><code class="lang-bash">docker stop mysql1
</code></pre>
<p><code>docker stop</code> 发送 SIGTERM 信号到 <a href="https://dev.mysql.com/doc/refman/8.0/en/mysqld.html" target="_blank">mysqld</a> 进程, 以便服务器正常关闭.</p>
<p>请注意, 当容器的主进程 (MySQL 服务器容器中的 <a href="https://dev.mysql.com/doc/refman/8.0/en/mysqld.html" target="_blank">mysqld</a>) 停止时, Docker 容器也会自动停止.</p>
<p>再次启动 MySQL 服务器容器:</p>
<pre><code class="lang-bash">docker start mysql1
</code></pre>
<p>重启 MySQL 服务器容器:</p>
<pre><code class="lang-bash">docker restart mysql1
</code></pre>
<p>删除 MySQL 容器, 先停止, 然后使用 <code>docker rm</code> 命令:</p>
<pre><code class="lang-bash">docker stop mysql1
</code></pre>
<pre><code class="lang-bash">docker rm mysql1
</code></pre>
<p>如果你想同时删除 <a href="https://dev.mysql.com/doc/refman/8.0/en/docker-mysql-more-topics.html#docker-persisting-data-configuration" target="_blank">服务器数据目录的 Docker volume</a>, 添加 <code>-v</code> 选项到 <code>docker rm</code> 命令.</p>
<h5 id="升级-mysql-服务器容器">升级 MySQL 服务器容器</h5>
<blockquote>
<p><strong>重要</strong></p>
<ul>
<li>在执行任何 MySQL 升级之前, 请仔细阅读 <a href="https://dev.mysql.com/doc/refman/8.0/en/upgrading.html" target="_blank">2.11节, “升级 MySQL”</a> 中的说明. 在这里讨论的其他说明中, 在升级前备份你的数据尤为重要.</li>
<li>本节要求在主机上保留服务器的数据和配置. 参阅 <a href="https://dev.mysql.com/doc/refman/8.0/en/docker-mysql-more-topics.html#docker-persisting-data-configuration" target="_blank">保留数据和配置更改</a> 获取详情.</li>
</ul>
</blockquote>
<p>按照以下步骤 MySQL Docker 安装从 5.7 升级到 8.0:</p>
<ul>
<li>停止 MySQL 5.7 服务器 (在这个示例中容器名称是 mysql57):</li>
</ul>
<pre><code class="lang-bash">docker stop mysql57
</code></pre>
<ul>
<li><p>下载 MySQL 8.0 服务器 Docker 镜像. 请参阅<a href="https://dev.mysql.com/doc/refman/8.0/en/docker-mysql-getting-started.html#docker-download-image" target="_blank">下载 MySQL 服务器 Docker 镜像</a>; 确保你对 MySQL 8.0 使用了正确的 tag.</p>
</li>
<li><p>使用在这个主机上持久化的 (在本例中使用 <a href="https://docs.docker.com/engine/reference/commandline/service_create/#add-bind-mounts-or-volumes" target="_blank">bind-mounting</a>) 旧的服务器数据和配置 (如有需要可适当修改—参阅 <a href="https://dev.mysql.com/doc/refman/8.0/en/upgrading.html" target="_blank">2.11节, “升级 MySQL”</a>) 启动新的 MySQL 8.0 Docker 容器 (在这个示例中命名为 <code>mysql80</code>). MySQL 社区服务器, 运行命令:</p>
</li>
</ul>
<pre><code class="lang-bash">docker run --name=mysql80 \
   --mount <span class="hljs-built_in">type</span>=<span class="hljs-built_in">bind</span>,src=/path-on-host-machine/my.cnf,dst=/etc/my.cnf \
   --mount <span class="hljs-built_in">type</span>=<span class="hljs-built_in">bind</span>,src=/path-on-host-machine/datadir,dst=/var/lib/mysql \        
   -d mysql/mysql-server:8.0
</code></pre>
<p>如果需要, 调整 <code>mysql/mysql-server</code> 为正确的库名称. 例如, 替换为 <code>store/oracle/mysql-enterprise-server</code> 是 Docker 商店的 MySQL 企业版镜像, 或者 <code>container-registry.oracle.com/mysql/enterprise-server</code> 是 Oracle 容器库的 MySQL 企业版镜像.</p>
<ul>
<li><p>等待服务器完成启动. 你可以使用 <code>docker ps</code> 命令检查服务器的状态 (参阅 <a href="https://dev.mysql.com/doc/refman/8.0/en/docker-mysql-getting-started.html#docker-starting-mysql-server" target="_blank">启动 MySQL 服务器实例</a> 获取如何操作).</p>
</li>
<li><p><em>对于 MySQL 8.0.15 和更早的</em>: 在 MySQL 8.0 服务器容器中运行 <a href="https://dev.mysql.com/doc/refman/8.0/en/mysql-upgrade.html" target="_blank">mysql_upgrade</a> 工具 (不支持 MySQL 8.0.16 和更高版本):</p>
</li>
</ul>
<pre><code class="lang-bash">docker <span class="hljs-built_in">exec</span> -it mysql80 mysql_upgrade -uroot -p
</code></pre>
<p>当提示时, 输入你的旧的 MySQL 5.7 服务器 root 密码.</p>
<ul>
<li>通过重启 MySQL 8.0 服务器容器完成升级:</li>
</ul>
<pre><code class="lang-bash">docker restart mysql80
</code></pre>
<h5 id="使用-docker-部署-mysql-服务器的更多主题">使用 Docker 部署 MySQL 服务器的更多主题</h5>
<p>有关使用Docker部署MySQL服务器的更多主题, 例如服务器配置, 持久化数据和配置, 服务器错误日志, 和容器环境变量, 参阅 <a href="https://dev.mysql.com/doc/refman/8.0/en/docker-mysql-more-topics.html" target="_blank">2.5.6.2节, “使用 Docker 部署 MySQL 服务器的更多主题”</a>.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="linux-installation-docker.html" class="navigation navigation-prev " aria-label="Previous page: 在 Linux 上使用 Docker 部署 MySQL">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="docker-mysql-more-topics.html" class="navigation navigation-next " aria-label="Next page: 使用 Docker 部署 MySQL 服务器的更多主题">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"使用 Docker 部署 MySQL 服务器的基本步骤","level":"1.3.1.2.1","depth":4,"next":{"title":"使用 Docker 部署 MySQL 服务器的更多主题","level":"1.3.1.2.2","depth":4,"path":"docker-mysql-more-topics.md","ref":"docker-mysql-more-topics.md","articles":[]},"previous":{"title":"在 Linux 上使用 Docker 部署 MySQL","level":"1.3.1.2","depth":3,"path":"linux-installation-docker.md","ref":"linux-installation-docker.md","articles":[{"title":"使用 Docker 部署 MySQL 服务器的基本步骤","level":"1.3.1.2.1","depth":4,"path":"docker-mysql-getting-started.md","ref":"docker-mysql-getting-started.md","articles":[]},{"title":"使用 Docker 部署 MySQL 服务器的更多主题","level":"1.3.1.2.2","depth":4,"path":"docker-mysql-more-topics.md","ref":"docker-mysql-more-topics.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"zh-hans","gitbook":"*"},"file":{"path":"docker-mysql-getting-started.md","mtime":"2023-05-27T13:02:39.318Z","type":"markdown"},"gitbook":{"version":"4.0.7","time":"2023-05-27T13:02:45.779Z"},"basePath":".","book":{"language":"zh-cn"}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

