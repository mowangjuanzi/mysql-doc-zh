
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <title>计算行数 · HonKit</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 4.0.7">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="multiple-tables.html" />
    
    
    <link rel="prev" href="pattern-matching.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="preface.html">
            
                <a href="preface.html">
            
                    
                    前言和法律条款
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="installing.html">
            
                <a href="installing.html">
            
                    
                    安装和更新 MySQL
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="linux-installation.html">
            
                <a href="linux-installation.html">
            
                    
                    在 Linux 上安装 MySQL
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.1" data-path="linux-installation-apt-repo.html">
            
                <a href="linux-installation-apt-repo.html">
            
                    
                    在 Linux 上使用 APT 库安装 MySQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2" data-path="linux-installation-docker.html">
            
                <a href="linux-installation-docker.html">
            
                    
                    在 Linux 上使用 Docker 部署 MySQL
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1.2.1" data-path="docker-mysql-getting-started.html">
            
                <a href="docker-mysql-getting-started.html">
            
                    
                    使用 Docker 部署 MySQL 服务器的基本步骤
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.1.2.2" data-path="docker-mysql-more-topics.html">
            
                <a href="docker-mysql-more-topics.html">
            
                    
                    使用 Docker 部署 MySQL 服务器的更多主题
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="tutorial.html">
            
                <a href="tutorial.html">
            
                    
                    教程
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="connecting-disconnecting.html">
            
                <a href="connecting-disconnecting.html">
            
                    
                    连接到服务器和从服务器断开
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="entering-queries.html">
            
                <a href="entering-queries.html">
            
                    
                    输入查询
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="database-use.html">
            
                <a href="database-use.html">
            
                    
                    创建和使用数据库
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="creating-database.html">
            
                <a href="creating-database.html">
            
                    
                    创建和选择数据库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="creating-tables.html">
            
                <a href="creating-tables.html">
            
                    
                    创建表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.3" data-path="loading-tables.html">
            
                <a href="loading-tables.html">
            
                    
                    将数据加载到表中
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4" data-path="retrieving-data.html">
            
                <a href="retrieving-data.html">
            
                    
                    从表中检索数据
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.4.1" data-path="selecting-all.html">
            
                <a href="selecting-all.html">
            
                    
                    选择所有数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.2" data-path="selecting-rows.html">
            
                <a href="selecting-rows.html">
            
                    
                    选择特定行
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.3" data-path="selecting-columns.html">
            
                <a href="selecting-columns.html">
            
                    
                    选择指定列
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.4" data-path="sorting-rows.html">
            
                <a href="sorting-rows.html">
            
                    
                    行排序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.5" data-path="date-calculations.html">
            
                <a href="date-calculations.html">
            
                    
                    日期计算
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.6" data-path="working-with-null.html">
            
                <a href="working-with-null.html">
            
                    
                    处理 NULL 值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.7" data-path="pattern-matching.html">
            
                <a href="pattern-matching.html">
            
                    
                    模式匹配
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.3.4.8" data-path="counting-rows.html">
            
                <a href="counting-rows.html">
            
                    
                    计算行数
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4.9" data-path="multiple-tables.html">
            
                <a href="multiple-tables.html">
            
                    
                    使用多个表
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="getting-information.html">
            
                <a href="getting-information.html">
            
                    
                    获取数据库和表的信息
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="batch-mode.html">
            
                <a href="batch-mode.html">
            
                    
                    在批处理模式使用 mysql
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="examples.html">
            
                <a href="examples.html">
            
                    
                    常见查询示例
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.6.1" data-path="example-maximum-column.html">
            
                <a href="example-maximum-column.html">
            
                    
                    列的最大值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.2" data-path="example-maximum-row.html">
            
                <a href="example-maximum-row.html">
            
                    
                    包含某一行最大值的记录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.3" data-path="example-maximum-column-group.html">
            
                <a href="example-maximum-column-group.html">
            
                    
                    每组中列的最大值
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.4" data-path="example-maximum-column-group-row.html">
            
                <a href="example-maximum-column-group-row.html">
            
                    
                    拥有某个字段的组间最大值的行
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.5" data-path="example-user-variables.html">
            
                <a href="example-user-variables.html">
            
                    
                    使用用户自定义变量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.6" data-path="example-foreign-keys.html">
            
                <a href="example-foreign-keys.html">
            
                    
                    使用外键
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.7" data-path="searching-on-two-keys.html">
            
                <a href="searching-on-two-keys.html">
            
                    
                    两个键上搜索
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.8" data-path="calculating-days.html">
            
                <a href="calculating-days.html">
            
                    
                    计算每日访问量
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6.9" data-path="example-auto-increment.html">
            
                <a href="example-auto-increment.html">
            
                    
                    使用 AUTO_INCREMENT
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="apache.html">
            
                <a href="apache.html">
            
                    
                    在 Apache 中使用 MySQL
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="programs.html">
            
                <a href="programs.html">
            
                    
                    MySQL 程序
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="programs-client.html">
            
                <a href="programs-client.html">
            
                    
                    MySQL 客户端程序
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1.1" data-path="mysql.html">
            
                <a href="mysql.html">
            
                    
                    mysql — MySQL 命令行客户端
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="optimization.html">
            
                <a href="optimization.html">
            
                    
                    优化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="optimize-overview.html">
            
                <a href="optimize-overview.html">
            
                    
                    优化概述
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="statement-optimization.html">
            
                <a href="statement-optimization.html">
            
                    
                    优化 SQL 语句
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="optimization-indexes.html">
            
                <a href="optimization-indexes.html">
            
                    
                    优化和索引
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="optimizing-database-structure.html">
            
                <a href="optimizing-database-structure.html">
            
                    
                    优化数据库结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="optimizing-innodb.html">
            
                <a href="optimizing-innodb.html">
            
                    
                    优化 InnoDB 表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="optimizing-myisam.html">
            
                <a href="optimizing-myisam.html">
            
                    
                    优化 MyISAM 表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.7" data-path="optimizing-memory-tables.html">
            
                <a href="optimizing-memory-tables.html">
            
                    
                    优化 MEMORY 表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.8" data-path="execution-plan-information.html">
            
                <a href="execution-plan-information.html">
            
                    
                    理解查询执行计划
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.9" data-path="controlling-optimizer.html">
            
                <a href="controlling-optimizer.html">
            
                    
                    控制查询优化器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.10" data-path="buffering-caching.html">
            
                <a href="buffering-caching.html">
            
                    
                    缓冲和缓存
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.11" data-path="locking-issues.html">
            
                <a href="locking-issues.html">
            
                    
                    优化锁操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.12" data-path="optimizing-server.html">
            
                <a href="optimizing-server.html">
            
                    
                    优化 MySQL 服务器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.13" data-path="optimize-benchmarking.html">
            
                <a href="optimize-benchmarking.html">
            
                    
                    测量性能 (Benchmarking)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.14" data-path="thread-information.html">
            
                <a href="thread-information.html">
            
                    
                    检查线程信息
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="data-types.html">
            
                <a href="data-types.html">
            
                    
                    数据类型
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            本书使用 HonKit 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >计算行数</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h4 id="3348-计算行数">3.3.4.8 计算行数</h4>
<p>数据库通常用于回答以下问题, “某一类型的数据在表中出现的频率是多少?” 例如, 你可能想知道你有多少宠物或者每个主人有多少宠物或者你可能对动物进行各种各样的普查.</p>
<p>计算你拥有的动物总数与“ pet 表中有多少条纪录?” 是同样的问题, 因为每只宠物只有一条纪录. <a href="https://dev.mysql.com/doc/refman/8.0/en/group-by-functions.html#function_count" target="_blank">COUNT(*)</a> 计算行数, 因此你的动物数量的查询如下:</p>
<pre><code class="lang-sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> pet;
<span class="hljs-operator">+</span><span class="hljs-comment">----------+</span>
<span class="hljs-operator">|</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">----------+</span>
<span class="hljs-operator">|</span>        <span class="hljs-number">9</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">----------+</span>
</code></pre>
<p>之前, 你检索了拥有宠物的人的名字. 如果你想找出每个主人拥有多少宠物, 你可以使用 <a href="https://dev.mysql.com/doc/refman/8.0/en/group-by-functions.html#function_count" target="_blank"><code>COUNT()</code></a>:</p>
<pre><code class="lang-sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> owner, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> pet <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> owner;
<span class="hljs-operator">+</span><span class="hljs-comment">--------+----------+</span>
<span class="hljs-operator">|</span> owner  <span class="hljs-operator">|</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------+----------+</span>
<span class="hljs-operator">|</span> Benny  <span class="hljs-operator">|</span>        <span class="hljs-number">2</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> Diane  <span class="hljs-operator">|</span>        <span class="hljs-number">2</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> Gwen   <span class="hljs-operator">|</span>        <span class="hljs-number">3</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> Harold <span class="hljs-operator">|</span>        <span class="hljs-number">2</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------+----------+</span>
</code></pre>
<p>前面的查询使用 <code>GROUP BY</code> 对每个 <code>owner</code> 的所有纪录进行分组. <a href="https://dev.mysql.com/doc/refman/8.0/en/group-by-functions.html#function_count" target="_blank"><code>COUNT()</code></a> 和 <code>GROUP BY</code> 结合使用, 对描述不同分组下的数据非常有用. 下面的例子展示了执行动物普查的不同方法.</p>
<p>每种动物的数量:</p>
<pre><code class="lang-sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> species, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> pet <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> species;
<span class="hljs-operator">+</span><span class="hljs-comment">---------+----------+</span>
<span class="hljs-operator">|</span> species <span class="hljs-operator">|</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">---------+----------+</span>
<span class="hljs-operator">|</span> bird    <span class="hljs-operator">|</span>        <span class="hljs-number">2</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> cat     <span class="hljs-operator">|</span>        <span class="hljs-number">2</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> dog     <span class="hljs-operator">|</span>        <span class="hljs-number">3</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> hamster <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> snake   <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">---------+----------+</span>
</code></pre>
<p>每个性别的动物数量:</p>
<pre><code class="lang-sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> sex, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> pet <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> sex;
<span class="hljs-operator">+</span><span class="hljs-comment">------+----------+</span>
<span class="hljs-operator">|</span> sex  <span class="hljs-operator">|</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">------+----------+</span>
<span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> f    <span class="hljs-operator">|</span>        <span class="hljs-number">4</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> m    <span class="hljs-operator">|</span>        <span class="hljs-number">4</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">------+----------+</span>
</code></pre>
<p>(在这个输出中, <code>NULL</code> 表示性别未知.)</p>
<p>按照动物的种类和性别组合计算数量:</p>
<pre><code class="lang-sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> species, sex, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> pet <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> species, sex;
<span class="hljs-operator">+</span><span class="hljs-comment">---------+------+----------+</span>
<span class="hljs-operator">|</span> species <span class="hljs-operator">|</span> sex  <span class="hljs-operator">|</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">---------+------+----------+</span>
<span class="hljs-operator">|</span> bird    <span class="hljs-operator">|</span> <span class="hljs-keyword">NULL</span> <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> bird    <span class="hljs-operator">|</span> f    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> cat     <span class="hljs-operator">|</span> f    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> cat     <span class="hljs-operator">|</span> m    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> dog     <span class="hljs-operator">|</span> f    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> dog     <span class="hljs-operator">|</span> m    <span class="hljs-operator">|</span>        <span class="hljs-number">2</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> hamster <span class="hljs-operator">|</span> f    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> snake   <span class="hljs-operator">|</span> m    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">---------+------+----------+</span>
</code></pre>
<p>你不需要使用<a href="https://dev.mysql.com/doc/refman/8.0/en/group-by-functions.html#function_count" target="_blank"><code>COUNT()</code></a> 时检索整个表. 例如, 在上一个查询, 仅对猫和狗进行查询, 如下所示:</p>
<pre><code class="lang-sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> species, sex, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> pet
       <span class="hljs-keyword">WHERE</span> species <span class="hljs-operator">=</span> <span class="hljs-string">&apos;dog&apos;</span> <span class="hljs-keyword">OR</span> species <span class="hljs-operator">=</span> <span class="hljs-string">&apos;cat&apos;</span>
       <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> species, sex;
<span class="hljs-operator">+</span><span class="hljs-comment">---------+------+----------+</span>
<span class="hljs-operator">|</span> species <span class="hljs-operator">|</span> sex  <span class="hljs-operator">|</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">---------+------+----------+</span>
<span class="hljs-operator">|</span> cat     <span class="hljs-operator">|</span> f    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> cat     <span class="hljs-operator">|</span> m    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> dog     <span class="hljs-operator">|</span> f    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> dog     <span class="hljs-operator">|</span> m    <span class="hljs-operator">|</span>        <span class="hljs-number">2</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">---------+------+----------+</span>
</code></pre>
<p>或者如果你想知道已知性别的动物每个性别的数量:</p>
<pre><code class="lang-sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> species, sex, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> pet
       <span class="hljs-keyword">WHERE</span> sex <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
       <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> species, sex;
<span class="hljs-operator">+</span><span class="hljs-comment">---------+------+----------+</span>
<span class="hljs-operator">|</span> species <span class="hljs-operator">|</span> sex  <span class="hljs-operator">|</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">---------+------+----------+</span>
<span class="hljs-operator">|</span> bird    <span class="hljs-operator">|</span> f    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> cat     <span class="hljs-operator">|</span> f    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> cat     <span class="hljs-operator">|</span> m    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> dog     <span class="hljs-operator">|</span> f    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> dog     <span class="hljs-operator">|</span> m    <span class="hljs-operator">|</span>        <span class="hljs-number">2</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> hamster <span class="hljs-operator">|</span> f    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> snake   <span class="hljs-operator">|</span> m    <span class="hljs-operator">|</span>        <span class="hljs-number">1</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">---------+------+----------+</span>
</code></pre>
<p>如果除了 <a href="https://dev.mysql.com/doc/refman/8.0/en/group-by-functions.html#function_count" target="_blank"><code>COUNT()</code></a> 值之外查询其他列, <code>GROUP BY</code> 子句应该用来命名为相同的列. 否则,会发生以下情况:</p>
<p>如果 <a href="https://dev.mysql.com/doc/refman/8.0/en/sql-mode.html#sqlmode_only_full_group_by" target="_blank"><code>ONLY_FULL_GROUP_BY</code></a> <a href="GLOSSARY.html#sql" class="glossary-term" title="The Structured Query Language that is standard for performing database operations. Often divided into the categories DDL, DML, and queries. MySQL includes some additional statement categories such as replication. See Chapter 9, Language Structure for the building blocks of SQL syntax, Chapter 11, Data Types for the data types to use for MySQL table columns, Chapter 13, SQL Statements for details about SQL statements and their associated categories, and Chapter 12, Functions and Operators for standard and MySQL-specific functions to use in queries.">SQL</a> 模式启用了, 则会出现以下错误:</p>
<pre><code class="lang-sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SET</span> sql_mode <span class="hljs-operator">=</span> <span class="hljs-string">&apos;ONLY_FULL_GROUP_BY&apos;</span>;
Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)

mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> owner, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> pet;
ERROR <span class="hljs-number">1140</span> (<span class="hljs-number">42000</span>): <span class="hljs-keyword">In</span> aggregated query <span class="hljs-keyword">without</span> <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>, expression
#<span class="hljs-number">1</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">SELECT</span> list <span class="hljs-keyword">contains</span> nonaggregated <span class="hljs-keyword">column</span> <span class="hljs-string">&apos;menagerie.pet.owner&apos;</span>;
this <span class="hljs-keyword">is</span> incompatible <span class="hljs-keyword">with</span> sql_mode<span class="hljs-operator">=</span>only_full_group_by
</code></pre>
<p>如果 <a href="https://dev.mysql.com/doc/refman/8.0/en/sql-mode.html#sqlmode_only_full_group_by" target="_blank"><code>ONLY_FULL_GROUP_BY</code></a> 未启用, 查询会将所有的纪录当做单个组来处理t, 但是为每个指定的列选择的值是不确定的. 服务器可以从任意行中自由选择值:</p>
<pre><code class="lang-sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SET</span> sql_mode <span class="hljs-operator">=</span> <span class="hljs-string">&apos;&apos;</span>;
Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)

mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">SELECT</span> owner, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">FROM</span> pet;
<span class="hljs-operator">+</span><span class="hljs-comment">--------+----------+</span>
<span class="hljs-operator">|</span> owner  <span class="hljs-operator">|</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------+----------+</span>
<span class="hljs-operator">|</span> Harold <span class="hljs-operator">|</span>        <span class="hljs-number">8</span> <span class="hljs-operator">|</span>
<span class="hljs-operator">+</span><span class="hljs-comment">--------+----------+</span>
<span class="hljs-number">1</span> <span class="hljs-type">row</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)
</code></pre>
<p>参阅 <a href="https://dev.mysql.com/doc/refman/8.0/en/group-by-handling.html" target="_blank">Section 12.20.3, “MySQL GROUP BY 处理”</a>. 参阅 <a href="https://dev.mysql.com/doc/refman/8.0/en/group-by-functions.html" target="_blank">Section 12.20.1, 聚合 (GROUP BY) 函数描述”</a> 获取有关 <a href="https://dev.mysql.com/doc/refman/8.0/en/group-by-functions.html#function_count" target="_blank"><code>COUNT(expr)</code></a> 行为和相关优化的信息.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="pattern-matching.html" class="navigation navigation-prev " aria-label="Previous page: 模式匹配">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="multiple-tables.html" class="navigation navigation-next " aria-label="Next page: 使用多个表">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"计算行数","level":"1.4.3.4.8","depth":4,"next":{"title":"使用多个表","level":"1.4.3.4.9","depth":4,"path":"multiple-tables.md","ref":"multiple-tables.md","articles":[]},"previous":{"title":"模式匹配","level":"1.4.3.4.7","depth":4,"path":"pattern-matching.md","ref":"pattern-matching.md","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"zh-hans","gitbook":"*"},"file":{"path":"counting-rows.md","mtime":"2023-05-27T13:02:39.318Z","type":"markdown"},"gitbook":{"version":"4.0.7","time":"2023-05-27T13:02:45.779Z"},"basePath":".","book":{"language":"zh-cn"}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

